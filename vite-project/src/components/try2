import React, { useEffect, useState } from 'react';
import AdminNav from '../../components/Admin/AdminNav';
import Table from 'react-bootstrap/Table';
import { Link } from 'react-router-dom';
import { collection, deleteDoc, getDocs } from 'firebase/firestore';
import { db } from '../../components/firebase';
import { doc } from 'firebase/firestore';
function RecipeDetails() {

  const [recipes, setrecipes]= useState([]);
  const fetchRec= async()=>{
    const response = await getDocs(collection(db,"Recipes"));
    console.log(response)
    const recipeList = response.docs.map(doc => ({id:doc.id, ...doc.data()}));
    setrecipes(recipeList);
    console.log(recipeList);
  }
  useEffect(()=>{
    fetchRec();
  },[])
  const handleDelete= async(id)=>{
    try {
      await deleteDoc(doc(db,"Recipes", id));
      fetchRec()
    } catch (error) {
      console.log(error)
    }
  }
  return (
    <>
      <div className="min-h-screen">
        {/* Sticky Navbar */}
        <div className="sticky top-0 z-20 bg-white shadow-md">
          <AdminNav />
        </div>

        {/* Main Content */}
        <div className="sticky top-20 max-w-5xl mx-auto px-6 py-10 flex flex-col items-center">
          <h2 className="text-2xl font-semibold mb-8 text-gray-800 text-center">
            Admin Panel
          </h2>
          

          {/* Table Wrapper */}
          <div className="w-full overflow-x-auto shadow-lg rounded-lg bg-white p-4">
            <Table
              striped
              bordered
              hover
              responsive
              className="text-center align-middle flex flex-col gap-5"
              style={{
                borderCollapse: 'separate',
                borderSpacing: '0 12px', 
              }}
            >
              <thead className="bg-gray-100">
                <tr className=' flex flex-row justify-between '>
                  <th className="px-4 py-3 text-left text-xs  uppercase tracking-wider w-16">serial no.</th>
                  <th className="px-4 py-3 text-left text-xs  uppercase tracking-wider w-16">User ID</th>
                  <th className="px-4 py-3 text-left text-xs  uppercase tracking-wider w-16">Email</th>
                  <th className="px-4 py-3 text-left text-xs  uppercase tracking-wider w-16">Title</th>
                  <th className="px-4 py-3 text-left text-xs  uppercase tracking-wider w-16">Description</th>
                  <th className="px-4 py-3 text-left text-xs  uppercase tracking-wider w-16">State</th>
                  <th className="px-4 py-3 text-left text-xs  uppercase tracking-wider w-16">tag</th>
                  <th className="px-4 py-3 text-left text-xs  uppercase tracking-wider w-16">Ingredients</th>
                  <th className="px-4 py-3 text-left text-xs  uppercase tracking-wider w-16">Instructions</th>
                  <th className="px-4 py-3 text-left text-xs  uppercase tracking-wider w-16">Preparation</th>
                  <th className="px-4 py-3 text-left text-xs  uppercase tracking-wider w-16">Total Time</th>
                  <th className="px-4 py-3 text-left text-xs  uppercase tracking-wider w-16">Action</th>
                </tr>
              </thead>
              <tbody className='flex flex-col gap-3 '>
                {recipes.length===0?(
                  <p>no Recipe found</p>
                ):(
                  recipes.map((recipe,index)=>(
                  <tr key={recipe.id} className=' flex flex-row justify-between '>
                    <td>{index+1}</td>
                  <td className="whitespace-normal break-words max-w-[90px]">{recipe.id}</td>
                  <td className="whitespace-normal break-words max-w-[90px]">{recipe.email}</td>
                  <td className="whitespace-normal break-words max-w-[90px]">{recipe.title}</td>
                  <td className="whitespace-normal break-words max-w-[90px]">{recipe.description}</td>
                  <td className="whitespace-normal break-words max-w-[90px]">{recipe.state}</td>
                  <td className="whitespace-normal break-words max-w-[90px]">{recipe.tag}</td>
                  <td className="whitespace-normal break-words max-w-[90px]">{recipe.ingredient}</td>
                  <td className="whitespace-normal break-words max-w-[90px]">{recipe.instruction}</td>
                  <td className="whitespace-normal break-words max-w-[90px]">{recipe.preparation}</td>
                  <td className="whitespace-normal break-words max-w-[90px]">{recipe.TotalTime}</td>
                 
                  <td>
                    <button onClick={()=> handleDelete(recipe.id)} className='bg-red-600 hover:bg-white rounded-lg p-2 text-white hover:text-red-600 outline hover:border-red-600'>
                      delete Recipe
                    </button>
                  </td>
                </tr>
                  ))
                )}
                
                
              </tbody>
            </Table>
          </div>
        </div>
      </div>
    </>
  );
}

export default RecipeDetails;
